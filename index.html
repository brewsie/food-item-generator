<!DOCTYPE html>
<html>
    <head>
        <title>APPLEBEES ME.NU</title>
        <meta charset='utf-8'/>
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <link href="https://fonts.googleapis.com/css?family=Amatic+SC" rel="stylesheet">
        <link rel="stylesheet" href="css/reset.css">
        <link rel="stylesheet" href="css/styles.css">
        <link href="favicon.ico" rel="shortcut icon" type="image/x-icon" />
    </head>
    <body>
        <div id="content">
            <h1>Applebees Me.nu</h1>
            <h2 id="intro"></h2>
            <div id="item"></div>
        </div>
        <script type="text/javascript">
            // Client ID and API key from the Developer Console
            var CLIENT_ID = '412546980134-oskpi8s81i76e8pp53ts6gh2aunk08qb.apps.googleusercontent.com';
            var API_KEY = 'AIzaSyC7q8GZkpvv_5uDWDRu_xGS5vVudWRKitA';

            // Array of API discovery doc URLs for APIs used by the quickstart
            var DISCOVERY_DOCS = ["https://sheets.googleapis.com/$discovery/rest?version=v4"];

            // Authorization scopes required by the API; multiple scopes can be
            // included, separated by spaces.
            var SCOPES = "https://www.googleapis.com/auth/spreadsheets.readonly";

            //Intro arrays
            var intros = [
                "Our special today is",
                "The lady will have the",
                "Try our new",
                "You look like a fan of our",
                "Take home an order of the",
                "Pass me the",
                "Our latest creation, the",
                "Your server Tammy recommends the",
                "We're almost out of the",
                "The manager Derek says don't miss the",
                "I don't always order off the menu, but when I do, I order the",
                "That commercial at half-time advertised the",
                "Back by popular demand!! The",
                "Why order filet when you could have",
                "Do menus typically have a clearance section? Whatever, I'll have the"
            ];
            /**
             *  On load, called to load the auth2 library and API client library.
             */
            function handleClientLoad() {
                gapi.load('client:auth2', initClient);
            }

            /**
             *  Initializes the API client library and sets up sign-in state
             *  listeners.
             */
            function initClient() {
                gapi.client.init({
                    apiKey: API_KEY,
                    //clientId: CLIENT_ID,
                    discoveryDocs: DISCOVERY_DOCS,
                    scope: SCOPES
                }).then(function () {
                    generateMenuItem();

                });
            }

            /**
             * Display the results of the API call.
             */
            function displayMessage(message) {
                var apbme = document.getElementById('item');
                apbme.innerHTML = message;

                //change intro
                var intro = document.getElementById('intro');
                var introMessage = intros[Math.floor(Math.random()*intros.length)];
                intro.innerHTML = introMessage + "...";
            }

            /**
             * Print the the items from sample spreadsheet:
             * https://docs.google.com/spreadsheets/d/1oPd2A26CD0AA9-6ZPbg64aniO7a_pqUws1tZeKRD_28
             */
            function generateMenuItem() {
                gapi.client.sheets.spreadsheets.values.get({
                    spreadsheetId: '1-0zar1rgg08pNDBiKqDcfdqmKMXTV5eB8vhSnsdbWEs',
                    range: 'A2:D'
                }).then(function (response) {
                    var range = response.result;
                    if (range.values.length > 0) {
                        // display a random sampling from all 4 columns
                        var col1 = range.values[Math.floor(Math.random() * range.values.length )][0];
                        var col2 = range.values[Math.floor(Math.random() * range.values.length )][1];
                        var col3 = range.values[Math.floor(Math.random() * range.values.length )][2];
                        var col4 = range.values[Math.floor(Math.random() * range.values.length )][3];

                        displayMessage(col1 + " " + col2 + " " + col3 + " " + col4);
                    } else {
                        displayMessage('No data found.');
                    }
                }, function (response) {
                    displayMessage('Error: ' + response.result.error.message);
                });
            }
        </script>

        <div>
            <a class="btn" href="#" onClick="generateMenuItem()">Next Course</a>
        </div>
        <script async defer src="https://apis.google.com/js/api.js"
                onload="this.onload=function(){};handleClientLoad()"
                onreadystatechange="if (this.readyState === 'complete') this.onload()">
        </script>
    </body>
</html>