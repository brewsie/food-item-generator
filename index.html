<!DOCTYPE html>
<html>
    <head>
        <title>Google Sheets API Quickstart</title>
        <meta charset='utf-8'/>
    </head>
    <body>
    <p>Mike's Applebee's style Menu Item Generator</p>

    <pre id="content"></pre>

    <script type="text/javascript">
        // Client ID and API key from the Developer Console
        var CLIENT_ID = '412546980134-oskpi8s81i76e8pp53ts6gh2aunk08qb.apps.googleusercontent.com';
        var API_KEY = 'AIzaSyC7q8GZkpvv_5uDWDRu_xGS5vVudWRKitA';

        // Array of API discovery doc URLs for APIs used by the quickstart
        var DISCOVERY_DOCS = ["https://sheets.googleapis.com/$discovery/rest?version=v4"];

        // Authorization scopes required by the API; multiple scopes can be
        // included, separated by spaces.
        var SCOPES = "https://www.googleapis.com/auth/spreadsheets.readonly";


        /**
         *  On load, called to load the auth2 library and API client library.
         */
        function handleClientLoad() {
            gapi.load('client:auth2', initClient);
        }

        /**
         *  Initializes the API client library and sets up sign-in state
         *  listeners.
         */
        function initClient() {
            gapi.client.init({
                apiKey: API_KEY,
                //clientId: CLIENT_ID,
                discoveryDocs: DISCOVERY_DOCS,
                scope: SCOPES
            }).then(function () {
                generateMenuItem();

            });
        }

        /**
         * Display the results of the API call.
         */
        function displayMessage(message) {
            var pre = document.getElementById('content');
            pre.textContent = message;
        }

        /**
         * Print the the items from sample spreadsheet:
         * https://docs.google.com/spreadsheets/d/1oPd2A26CD0AA9-6ZPbg64aniO7a_pqUws1tZeKRD_28
         */
        function generateMenuItem() {
            gapi.client.sheets.spreadsheets.values.get({
                spreadsheetId: '1oPd2A26CD0AA9-6ZPbg64aniO7a_pqUws1tZeKRD_28',
                range: 'A2:D'
            }).then(function (response) {
                var range = response.result;
                if (range.values.length > 0) {
                    // display a random sampling from all 4 columns
                    var col1 = range.values[Math.floor(Math.random(range.values.length) * 20)][0];
                    var col2 = range.values[Math.floor(Math.random(range.values.length) * 20)][1];
                    var col3 = range.values[Math.floor(Math.random(range.values.length) * 20)][2];
                    var col4 = range.values[Math.floor(Math.random(range.values.length) * 20)][3];

                    displayMessage(col1 + " " + col2 + " " + col3 + " " + col4);
                } else {
                    displayMessage('No data found.');
                }
            }, function (response) {
                displayMessage('Error: ' + response.result.error.message);
            });
        }
    </script>

    <a href="#" onClick="generateMenuItem()">Generate a new item</a>

    <script async defer src="https://apis.google.com/js/api.js"
            onload="this.onload=function(){};handleClientLoad()"
            onreadystatechange="if (this.readyState === 'complete') this.onload()">
    </script>
    </body>
</html>